<!DOCTYPE html>
<html>
  <head>
    <%= csrf_meta_tag %>

    <meta charset="utf-8" />

    <title><%= h(@page_title || application_name) %></title>
    <!-- application css -->
    <%= stylesheet_link_tag 'application' %>
    <%= yield(:css_head) %>

    <!-- application js -->
    <%= javascript_include_tag 'application' %>

    <!-- controller specific uploader -->
    <%= yield(:js_head) %>

    <script type="text/javascript">
      $(function() {
        <%= yield(:local_js) %>
      });
    </script>

    <%= render :partial => '/ga', :formats => [:html] %>

    <style type="text/css">
      <%= yield(:local_css) %>
    </style>
  </head>

<%# need a better way to determine if we are on the home page and using three col layout %>
<% if params[:controller].eql?("catalog") and !has_search_parameters? %> 
  <% column_class = "three" %>
<% elsif not ['generic_files', 'batches'].include?(params[:controller]) %>
  <% column_class = "two" %>
<% else %>
  <% column_class = "one" %>
<% end %>

<body> 
<div  id="wrapper"> 
  <div class="container">
    <div id="page-positioner">
      <%= render :partial => '/user_util_links', :formats => [:html] %>
      <%= render :partial => '/flash_msg' %>
      <div id="content-wrapper"> 
        <div id="content" class="row">
          <!-- 110 rows -->
          <% if column_class == "one" %>
            <div class="span110">
              <%= yield %>
            </div>
          <% else %>
            <div class="span17">
              <%= sidebar_items.join('').html_safe %> 
            </div><!-- /.span17 -->
            <% if column_class == "three" %>
              <div class="span63">
                <%= yield %>
              </div><!-- /.span63 -->

              <div class="span30">
                <h2 class="heading1">Contribute</h2> 
                <%= link_to 'Submit Your Work', new_generic_file_path, :class => "btn btn-primary btn-large", :id => "contribute_link" %><br />
                <div class="row">&nbsp;</div>
                <div class="row">&nbsp;</div>
                <h2 class="heading1">Recently Added</h2> 
                <%= render :partial=>'/catalog/recents' %>
              </div> <!-- /.span30 -->
            <% else %>
              <div class="span93">
                <%= yield %>
              </div><!-- /.span93 -->
            <% end %>
          <% end %>

        </div><!-- /#content -->
      </div><!-- /#content-wrapper -->
    </div><!-- /#page-positioner -->
  </div><!-- /.container -->
</div><!-- /#wrapper -->
<div id="footer-wrapper" class="row-fluid">
  <div id="footer">
    <div class="footer-logo">
      <a href="/"><img src="/assets/site_images/logo_psuss_footer.png" alt="PSU ScholarSphere" /></a>
      <p>A service of the University Libraries and Information Technology Services.</p>
    </div>
    <div class="footer-text">
      <p><strong>Copyright &copy; 2012 The Pennsylvania State University</strong></p>
      <ul>
        <li><a href="http://psu.edu">Penn State</a></li>
        <li><a href="http://libraries.psu.edu">University Libraries</a></li>
        <li><a href="http://its.psu.edu">Information Technology Services</a></li>
        <li><a href="http://accessibility.psu.edu/">Accessibility</a></li>
      </ul>
    </div>
    <div class="clearfix"></div>
  </div><!-- /footer -->
</div><!-- /footer-wrapper -->
</body>
</html>
